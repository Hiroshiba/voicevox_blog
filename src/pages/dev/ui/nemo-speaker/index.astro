---
import SpeakerComponent from "@/pages/nemo/_SpeakerComponent.astro";
import { getSpeakerInfo } from "@/pages/nemo/constants";
import "@/styles/bulma.scss";
import "@/styles/global.scss";
import "@/styles/helper.scss";

const speakerInfos = [
  getSpeakerInfo("nemo_female_002"),
  getSpeakerInfo("nemo_male_001"),
];
---

<html lang="ja" class="has-background-black-bis">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="robots" content="noindex, nofollow" />
    <title>SpeakerComponent (nemo) 確認用ページ</title>
  </head>
  <body class="has-background-black has-text-white">
    <div class="nemo-speaker-preview" style="padding: 2rem;">
      <h1 class="text-2xl font-bold mb-6">
        SpeakerComponent (nemo) 確認用ページ
      </h1>

      <section class="mb-8">
        <h2 class="text-xl font-semibold mb-4">デフォルト</h2>
        <div class="speakers-container container is-max-desktop">
          {
            speakerInfos.map((info, i) => (
              <SpeakerComponent
                info={info}
                style={{ zIndex: speakerInfos.length - i }}
              />
            ))
          }
        </div>
      </section>

      <section class="mb-8">
        <h2 class="text-xl font-semibold mb-4">
          CVドロップダウン（開いた状態）
        </h2>
        <div class="dropdown-force-open">
          <div class="speakers-container container is-max-desktop">
            <SpeakerComponent info={speakerInfos[0]} style={{ zIndex: 1 }} />
          </div>
        </div>
      </section>
    </div>
  </body>
</html>

<style lang="scss" is:global>
  /* NOTE: src/pages/nemo/index.astro の is:global スタイルを dev/ui でも再現するため、必要最小限を複製しています */
  @use "@/styles/helper.scss" as *;
  @use "bulma/sass/utilities/initial-variables" as *;
  @use "bulma/sass/utilities/mixins" as *;

  .nemo-speaker-preview {
    min-height: 100vh;
  }

  .speakers-container {
    display: grid;
    gap: $gap;
    grid-template-columns: repeat(2, 1fr);
    place-content: center;

    @include mobile {
      grid-template-columns: repeat(1, minmax(0, 25rem));
    }

    .speaker {
      display: flex;
      flex-direction: row;
      padding-right: 1rem;

      position: relative; // 背景用
      filter: drop-shadow(12px 12px 8px rgba(0, 0, 0, 0.5));

      * {
        z-index: 2;
      }

      --height: 8rem;
      @include touch {
        --height: 6rem;
      }
      @include mobile {
        --height: 4rem;
      }

      // 背景
      &::before {
        content: "";
        background: #20242d;
        position: absolute;
        top: 0.4rem;
        left: 0.4rem;
        bottom: 0.4rem;
        right: 0;
        border-top-left-radius: calc(var(--height) - 0.4rem);
        border-bottom-left-radius: calc(var(--height) - 0.4rem);
        z-index: 1;
      }

      .speaker-icon-wrapper {
        height: var(--height);
        width: var(--height);
        flex: 0 0 auto;
      }

      .speaker-labels {
        flex: 1 1 auto;

        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        gap: 0.5rem;

        @include touch {
          gap: 0.25rem;
        }

        .cv {
          @extend .is-size-7;
          @extend .is-size-6-desktop;
        }
        h3 {
          @extend .is-size-5-desktop;
        }

        .dropdown {
          .dropdown-trigger {
            .button {
              @extend .is-ghost;
              color: white;
              text-decoration: underline;
              @extend .py-0;
              height: auto;
              &:active,
              &:focus,
              &:hover {
                color: white;
              }
            }
          }

          .dropdown-content {
            @extend .has-background-dark;

            .dropdown-item {
              display: flex;
              flex-direction: column;
              text-align: center;
              align-items: center;

              @extend .has-text-white;

              .button {
                @extend .circle-icon;
                @extend .ml-auto;
                @extend .is-dark;
                @extend .is-medium;
                @extend .has-text-white;
                @extend .mb-0;
              }
            }
          }
        }
      }

      .sample-voices {
        flex: 0 0 auto;

        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: center;
        gap: 1rem;
      }
    }
  }

  /* Bulma dropdown の開閉を再現するため、devページでは強制的に開ける */
  .dropdown-force-open {
    padding-bottom: 8rem;

    .dropdown-menu {
      display: block;
    }
  }
</style>
